version: '3.8'

services:
  redis-stack-1:
    image: redis/redis-stack-server:latest
    container_name: redis-stack-1
    ports:
      - "7379:6379"
    environment:
      - REDIS_CLUSTER_ENABLED=yes
      - REDIS_PASSWORD=your_password
    command: ["redis-server", "--cluster-enabled", "yes", "--cluster-config-file", "/data/nodes.conf", "--cluster-node-timeout", "5000", "--appendonly", "yes"]

  redis-stack-2:
    image: redis/redis-stack-server:latest
    container_name: redis-stack-2
    ports:
      - "7380:6379"
    environment:
      - REDIS_CLUSTER_ENABLED=yes
      - REDIS_PASSWORD=your_password
    command: ["redis-server", "--cluster-enabled", "yes", "--cluster-config-file", "/data/nodes.conf", "--cluster-node-timeout", "5000", "--appendonly", "yes"]

  redis-stack-3:
    image: redis/redis-stack-server:latest
    container_name: redis-stack-3
    ports:
      - "7381:6379"
    environment:
      - REDIS_CLUSTER_ENABLED=yes
      - REDIS_PASSWORD=your_password
    command: ["redis-server", "--cluster-enabled", "yes", "--cluster-config-file", "/data/nodes.conf", "--cluster-node-timeout", "5000", "--appendonly", "yes"]